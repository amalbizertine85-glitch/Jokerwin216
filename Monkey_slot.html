<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Monkey Slot â€” Prototype</title>
<style>
  :root{--bg:#05221a;--panel:#0b2e25;--accent:#ffd166;--muted:#9fcfb1}
  body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#fff;display:flex;align-items:center;justify-content:center;height:100vh;margin:0;padding:20px}
  .wrap{width:980px;max-width:100%;background:linear-gradient(180deg,#063327 0,#0b2e25 100%);border-radius:12px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.6)}
  .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .title{font-size:20px;font-weight:700;color:var(--accent)}
  .info{display:flex;gap:10px;align-items:center}
  .chip{background:var(--panel);padding:8px 12px;border-radius:8px;color:var(--muted);font-weight:600}
  .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;background:rgba(255,255,255,0.03);padding:14px;border-radius:10px}
  .reel{background:rgba(0,0,0,0.15);border-radius:8px;padding:8px;min-height:160px;display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center}
  .cell{width:100%;height:42px;border-radius:6px;background:rgba(255,255,255,0.04);display:flex;align-items:center;justify-content:center;font-size:28px;transition:transform .4s}
  .controls{display:flex;gap:10px;align-items:center;margin-top:12px}
  button{background:var(--accent);border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:700}
  .small{background:var(--panel);color:var(--muted);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
  .bet-row{display:flex;gap:8px;align-items:center}
  .message{margin-top:12px;color:var(--muted)}
  .anim-spin{transform:translateY(-8px);transition:transform .25s}
  .footer{margin-top:10px;color:#bfe8d3;font-size:13px}
</style>
</head>
<body>
<div class="wrap" dir="rtl">
  <div class="top">
    <div class="title">Monkey Slot â€” Prototype</div>
    <div class="info">
      <div class="chip">Ø§Ù„Ø±ØµÙŠØ¯: <span id="balance">100.00</span></div>
      <div class="chip">Free Spins: <span id="freespins">0</span></div>
    </div>
  </div>

  <div class="grid" id="grid">
    <!-- 5 reels -->
    <div class="reel" data-reel="0"><div class="cell">â“</div><div class="cell">â“</div><div class="cell">â“</div></div>
    <div class="reel" data-reel="1"><div class="cell">â“</div><div class="cell">â“</div><div class="cell">â“</div></div>
    <div class="reel" data-reel="2"><div class="cell">â“</div><div class="cell">â“</div><div class="cell">â“</div></div>
    <div class="reel" data-reel="3"><div class="cell">â“</div><div class="cell">â“</div><div class="cell">â“</div></div>
    <div class="reel" data-reel="4"><div class="cell">â“</div><div class="cell">â“</div><div class="cell">â“</div></div>
  </div>

  <div class="controls">
    <div class="bet-row">
      <button id="spin">SPIN</button>
      <div class="small">Bet: <span id="bet">1.00</span></div>
      <button class="small" id="bet-down">âˆ’0.2</button>
      <button class="small" id="bet-up">+0.2</button>
    </div>
    <div style="flex:1"></div>
    <button class="small" id="auto">Auto Ã—10</button>
    <button class="small" id="reset">Reset</button>
  </div>

  <div class="message" id="message">Ø§Ø¶ØºØ· SPIN Ù„ØªØ¨Ø¯Ø£ â€” Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø®Ø§Øµ (Ø¬ÙˆÙ‡Ø±Ø© ğŸ’) ÙŠØ¹Ø·ÙŠ Free Spins Ø¹Ù†Ø¯ 3 Ø£Ùˆ Ø£ÙƒØ«Ø±.</div>
  <div class="footer">Prototype â€” Ø±Ù…ÙˆØ² Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ù…ÙƒØ§Ù† ØµÙˆØ±Ø› Ù†Ù‚Ø¯Ø± Ù†Ø¨Ø¯Ù‘Ù„Ù‡Ù… Ø¨ØµÙˆØ± Ù„Ø§Ø­Ù‚Ø§Ù‹.</div>
</div>

<script>
(() => {
  const symbols = ['ğŸ’','ğŸŒ','ğŸ””','ğŸ’','ğŸ‰','â­']; // simple symbols
  const special = 'ğŸ’'; // jewel triggers free spins
  const reels = 5, rows = 3;

  let balance = 100.0;
  let bet = 1.0;
  let freeSpins = 0;
  let spinning = false;

  const balanceEl = document.getElementById('balance');
  const betEl = document.getElementById('bet');
  const fsEl = document.getElementById('freespins');
  const grid = document.getElementById('grid');
  const msg = document.getElementById('message');

  const updateUI = ()=> {
    balanceEl.textContent = balance.toFixed(2);
    betEl.textContent = bet.toFixed(2);
    fsEl.textContent = freeSpins;
  };

  function randomSymbol(){ return symbols[Math.floor(Math.random()*symbols.length)]; }

  function spinOnce(){ // returns matrix [reel][row]
    const result = [];
    for(let r=0;r<reels;r++){
      const col=[];
      for(let y=0;y<rows;y++) col.push(randomSymbol());
      result.push(col);
    }
    return result;
  }

  function renderResult(matrix){
    const reelEls = grid.querySelectorAll('.reel');
    matrix.forEach((col,ci)=>{
      const cells = reelEls[ci].querySelectorAll('.cell');
      col.forEach((sym,ri)=>{
        cells[ri].textContent = sym;
        // quick anim
        cells[ri].classList.remove('anim-spin');
        void cells[ri].offsetWidth;
        cells[ri].classList.add('anim-spin');
      });
    });
  }

  function evaluate(matrix){
    // simple evaluation: count occurrences of special symbol anywhere
    let specialCount=0;
    matrix.flat().forEach(s=>{ if(s===special) specialCount++; });
    // pay-lines simplified: if any 3 same symbols on central row across adjacent reels -> reward
    const centerRowIndex = 1;
    let paylinesWin = 0;
    for(let start=0; start<=reels-3; start++){
      const a = matrix[start][centerRowIndex];
      if(a===matrix[start+1][centerRowIndex] && a===matrix[start+2][centerRowIndex]) {
        if(a===special) paylinesWin += bet * 10;
        else paylinesWin += bet * 2;
      }
    }
    return {specialCount, paylinesWin};
  }

  async function doSpin(){
    if(spinning) return;
    if(balance < bet && freeSpins<=0){ msg.textContent='Ø§Ù„Ø±ØµÙŠØ¯ Ù‚Ù„ÙŠÙ„'; return; }
    spinning = true;
    if(freeSpins>0){ freeSpins--; msg.textContent='Free Spin ÙØ¹Ø§Ù„!'; }
    else balance = Math.max(0, balance - bet);

    updateUI();
    // simulate reel spinning with small delays and random fills
    for(let r=0;r<reels;r++){
      const partial = spinOnce();
      renderResult(partial);
      await new Promise(res=>setTimeout(res, 120 + Math.random()*120));
    }
    const final = spinOnce();
    renderResult(final);
    const res = evaluate(final);
    // apply wins
    if(res.paylinesWin>0){
      balance += res.paylinesWin;
      msg.textContent = 'ÙØ²Øª Ø¨Ù€ ' + res.paylinesWin.toFixed(2) + ' (paylines)';
    } else {
      msg.textContent = 'Ù…Ø§ ÙÙŠ ÙÙˆØ² Ù‡Ø§Ù„Ù…Ø±Ø©';
    }
    // special -> award free spins
    if(res.specialCount >= 3){
      const award = 3 + (res.specialCount - 3); // Ù…Ø«Ø§Ù„: 3->3 spins, 4->4, 5->5
      freeSpins += award;
      msg.textContent += ' â€” Ø¬Ø§ÙƒÙŠØª:+'+award+' Free Spins';
    }
    updateUI();
    spinning = false;
  }

  document.getElementById('spin').addEventListener('click', doSpin);
  document.getElementById('bet-up').addEventListener('click', ()=>{ bet = Math.round((bet+0.2)*100)/100; updateUI(); });
  document.getElementById('bet-down').addEventListener('click', ()=>{ bet = Math.max(0.2, Math.round((bet-0.2)*100)/100); updateUI(); });
  document.getElementById('reset').addEventListener('click', ()=>{ balance=100; bet=1; freeSpins=0; msg.textContent='Reset done'; updateUI(); });
  document.getElementById('auto').addEventListener('click', async ()=>{
    for(let i=0;i<10;i++){ if(spinning) break; await doSpin(); await new Promise(r=>setTimeout(r,200)); if(balance<bet && freeSpins<=0) break; }
  });

  // initial fill
  renderResult(spinOnce());
  updateUI();
})();
</script>
</body>
</html>
