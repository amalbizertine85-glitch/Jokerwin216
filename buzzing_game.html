<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>3 Buzzing Wilds â€” Game</title>

<style>
  :root{
    --bg:#000;
    --panel:#042a00;
    --accent:#1bd14b;
    --muted:#c7f7cf;
    --danger:#c62828;
    --ui:rgba(0,0,0,0.55);
  }

  html,body{
      height:100%;
      margin:0;
      background:#000;
      font-family:Arial,Helvetica,sans-serif;
      color:#fff;
  }

  body{
      background:url("buzzing.jpeg") center/cover no-repeat fixed;
  }

  .top{
      height:60px;
      background:#000c;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:20px;
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter:blur(4px);
  }

  .container{
      max-width:900px;
      margin:10px auto;
      padding:12px;
      background:rgba(0,0,0,0.5);
      border-radius:12px;
  }

  /* REELS */
  .reels{
      width:100%;
      border-radius:12px;
      padding:14px;
      box-sizing:border-box;
      display:flex;
      gap:10px;
      justify-content:center;
      overflow:hidden;
      background:rgba(0,0,0,0.45);
  }

  .reel{
      width:18%;
      height:300px;
      background:rgba(0,0,0,0.55);
      border-radius:10px;
      overflow:hidden;
      position:relative;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      box-shadow:0 0 12px #000;
      backdrop-filter:blur(6px);
  }

  .reel-track{
      position:absolute;
      top:0;
      width:100%;
      transition: transform 900ms cubic-bezier(.2,.9,.2,1);
  }

  .symbol{
      width:100%;
      height:100px;
      display:flex;
      align-items:center;
      justify-content:center;
  }

  .symbol img{
      max-width:100%;
      max-height:100%;
      object-fit:contain;
  }

  /* CONTROLS */
  .controls{
      margin-top:14px;
      background:rgba(0,0,0,0.65);
      padding:14px;
      border-radius:10px;
      text-align:center;
  }

  .stat{font-size:18px;margin:6px 0}

  .row{
      display:flex;
      justify-content:center;
      gap:10px;
      margin-top:10px;
  }

  .btn{
      background:#004d15;
      color:#fff;
      border:2px solid #0a0;
      padding:10px 14px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
  }

  .spin{
      background:#11c751;
      border-color:#11c751;
      font-size:20px;
  }

  .quit{
      background:#c62828;
      padding:10px 12px;
      border-radius:8px;
      color:#fff;
  }

  /* BOTTOM MENU */
  .bottom{
      position:fixed;
      left:0;
      right:0;
      bottom:0;
      height:68px;
      background:#000;
      display:flex;
      justify-content:space-around;
      align-items:center;
      border-top:1px solid rgba(255,255,255,0.1);
  }

  .bottom a{
      color:#fff;
      text-decoration:none;
      text-align:center;
  }
</style>
</head>

<body>

<div class="top">3 Buzzing Wilds</div>

<div class="container">

  <div class="reels">
    <div class="reel"><div class="reel-track" id="track-0"></div></div>
    <div class="reel"><div class="reel-track" id="track-1"></div></div>
    <div class="reel"><div class="reel-track" id="track-2"></div></div>
    <div class="reel"><div class="reel-track" id="track-3"></div></div>
    <div class="reel"><div class="reel-track" id="track-4"></div></div>
  </div>

  <div class="controls">
      <div class="stat">Credit: <span id="balance">0.00</span> TND</div>
      <div class="stat">Bet: <span id="bet">1.00</span> TND</div>

      <div class="row">
        <button class="btn" id="dec">- 0.2</button>
        <button class="btn spin" id="spinBtn">SPIN</button>
        <button class="btn" id="inc">+ 0.2</button>
        <button class="quit" id="quitBtn">Quit</button>
      </div>
  </div>

</div>

<div class="bottom">
  <a href="player_home.html">Home</a>
  <a href="#">Account</a>
  <a href="#">Sport</a>
  <a href="#">Slip</a>
</div>

<script>
const BIN_ID = "692eeefbae596e708f7e9e72";
const API_KEY = "$2a$10$hCALb9EdUjLfi38M4RhCMOdm8.1y36yYtLvW0BYdZTfqjpHtlAY7S";

let username = localStorage.getItem("logged");
let balance = 0;
let bet = 1.00;

const SYMBOLS = [
  "buzzing.jpeg",
  "buzzing.jpeg",
  "buzzing.jpeg"
];

function initReels(){
    for(let r=0;r<5;r++){
        const track = document.getElementById(`track-${r}`);
        for(let i=0;i<12;i++){
            const div = document.createElement("div"); div.className="symbol";
            const img = document.createElement("img"); img.src = SYMBOLS[i%3];
            div.appendChild(img); track.appendChild(div);
        }
    }
}

async function loadBalance(){
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`,{
        headers:{ "X-Master-Key":API_KEY }
    });
    const data = await res.json();
    const users = data.record.users || {};
    balance = users[username]?.balance || 0;
    document.getElementById("balance").innerText = balance.toFixed(2);
}
async function saveBalance(){
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`,{
        headers:{ "X-Master-Key":API_KEY }
    });
    const data = await res.json();
    const rec = data.record;
    rec.users[username].balance = balance;
    await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`,{
        method:"PUT",
        headers:{
            "Content-Type":"application/json",
            "X-Master-Key":API_KEY
        },
        body:JSON.stringify(rec)
    });
}

function updateUI(){
    document.getElementById("balance").innerText = balance.toFixed(2);
    document.getElementById("bet").innerText = bet.toFixed(2);
}

document.getElementById("dec").onclick = ()=>{
    if(bet > 0.2){ bet = +(bet - 0.2).toFixed(2); updateUI(); }
};

document.getElementById("inc").onclick = ()=>{
    bet = +(bet + 0.2).toFixed(2);
    updateUI();
};

document.getElementById("quitBtn").onclick = ()=>{
    window.location.href = "casino.html";
};

document.getElementById("spinBtn").onclick = async ()=>{
    if(balance < bet){
        alert("Not enough balance!");
        return;
    }
    balance -= bet;
    updateUI();
    await saveBalance();
};

initReels();
loadBalance();
updateUI();
</script>

</body>
</html>
